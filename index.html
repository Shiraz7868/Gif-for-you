<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Final Test</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body style="background-color: #222; color: white; text-align: center; font-family: sans-serif; padding-top: 50px;">

    <h1>Supabase Connection Check</h1>
    <p>Open this page and click the button.</p>

    <button onclick="sendData()" style="padding: 15px 30px; font-size: 20px; cursor: pointer; background: green; color: white; border: none;">
        CLICK ME TO TEST
    </button>

    <p id="msg" style="margin-top: 20px; font-size: 18px;">Waiting...</p>

    <script>
        // 1. سب سے پہلے یہ چیک کریں کہ جاوا اسکرپٹ چل رہی ہے یا نہیں
        alert("System Ready! Code is working.");

        // --- SUPABASE SETTINGS ---
        const SUPABASE_URL = 'https://mlcbjfnimbpatmbcgwsq.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_J1WdZTnnDUCBE6bsTf2brQ_qRlXL_1Z'; 
        
        // Supabase کو کنیکٹ کرنا
        let supabase;
        try {
            supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
            console.log("Supabase initialized");
        } catch (err) {
            alert("Error: Supabase library not loaded. Check Internet.");
        }

        async function sendData() {
            const msgBox = document.getElementById('msg');
            msgBox.innerText = "Connecting...";
            msgBox.style.color = "yellow";

            console.log("Button Clicked. Sending data...");

            // ڈمی ڈیٹا بھیجنا
            const { error } = await supabase
                .from('captured_photos')
                .insert([{ image_url: "https://placehold.co/100x100/png?text=Success" }]);

            if (error) {
                console.error(error);
                alert("Database Error: " + error.message);
                msgBox.innerText = "Failed: " + error.message;
            } else {
                alert("Mubarak Ho! Data sent successfully.");
                msgBox.innerText = "✅ Data Sent! Check Admin Page.";
                msgBox.style.color = "#00ff00";
            }
        }
    </script>
</body>
</html>
